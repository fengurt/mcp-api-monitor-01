<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Monitor Platform</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login/Registration Screen -->
    <div id="authScreen" class="auth-container">
        <div class="auth-box">
            <h1>üöÄ API Monitor Platform</h1>
            <p class="subtitle">Manage your APIs, MCPs, and AI Models</p>
            
            <div class="auth-tabs">
                <button class="tab-btn active" data-tab="login">Login</button>
                <button class="tab-btn" data-tab="register">Register</button>
            </div>

            <form id="loginForm" class="auth-form active">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="btn btn-primary btn-block">Login</button>
            </form>

            <form id="registerForm" class="auth-form">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="registerName" required placeholder="Your Name">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="registerEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="registerPassword" required minlength="6" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="btn btn-primary btn-block">Register</button>
            </form>

            <div id="authError" class="error-message"></div>
        </div>
    </div>

    <!-- Main Application (hidden initially) -->
    <div id="appScreen" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1>üöÄ API Monitor Platform</h1>
            </div>
            <div class="header-right">
                <span id="userEmail" class="user-info"></span>
                <button id="logoutBtn" class="btn btn-secondary">Logout</button>
            </div>
            <div id="adminBadge" style="display: none; margin-left: 1rem; padding: 0.25rem 0.75rem; background: var(--primary-color); color: white; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600;">
                ADMIN
            </div>
        </header>

        <!-- Navigation -->
        <nav class="app-nav">
            <button class="nav-btn active" data-page="dashboard">üìä Dashboard</button>
            <button class="nav-btn" data-page="add-api">‚ûï Add API/MCP</button>
            <button class="nav-btn" data-page="models">ü§ñ AI Models</button>
        </nav>

        <!-- Dashboard Page -->
        <div id="dashboardPage" class="page active">
            <div class="page-header">
                <h2>Monitored APIs & MCPs</h2>
                <div class="stats-bar">
                    <div class="stat-card">
                        <div class="stat-value" id="totalApis">0</div>
                        <div class="stat-label">Total APIs</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeApis">0</div>
                        <div class="stat-label">Active</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalModels">0</div>
                        <div class="stat-label">AI Models</div>
                    </div>
                </div>
            </div>

            <div class="search-bar">
                <input type="text" id="apiSearch" placeholder="Search APIs/MCPs..." class="search-input">
            </div>

            <div id="apisList" class="apis-grid">
                <!-- APIs will be dynamically added here -->
            </div>
        </div>

        <!-- Add API/MCP Page -->
        <div id="addApiPage" class="page">
            <div class="page-header">
                <h2>Add New API/MCP</h2>
                <p class="page-subtitle">Paste your API code sample. Our AI will analyze and extract the structure.</p>
            </div>

            <div class="add-api-container">
                <div class="input-section">
                    <label for="apiCodeInput">API Code Sample</label>
                    <textarea 
                        id="apiCodeInput" 
                        class="code-input" 
                        placeholder="Paste your API code here, for example:&#10;&#10;async function fetchRecipeEntities() {&#10;    const response = await fetch(`https://app.base44.com/api/apps/6907f8149df3a6b0ccf8bfb3/entities/Recipe`, {&#10;        headers: {&#10;            'api_key': '674dc575177a4851b7a276bf7084f85b',&#10;            'Content-Type': 'application/json'&#10;        }&#10;    });&#10;    const data = await response.json();&#10;    return data;&#10;}"
                        rows="15"></textarea>
                    <div class="input-actions">
                        <button id="analyzeBtn" class="btn btn-primary">ü§ñ Analyze with AI</button>
                        <button id="clearInputBtn" class="btn btn-secondary">Clear</button>
                    </div>
                </div>

                <div id="analysisResult" class="analysis-result" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>AI Analysis Result</h3>
                        <button id="editAnalysisBtn" class="btn btn-small btn-secondary">‚úèÔ∏è Edit</button>
                    </div>
                    
                    <div id="analysisContent"></div>
                    
                    <div id="analysisForm" class="form-section">
                        <div class="form-row">
                            <div class="form-group" style="flex: 1;">
                                <label>API Name *</label>
                                <input type="text" id="apiName" required placeholder="e.g., Recipe API">
                            </div>
                            <div class="form-group" style="flex: 1;">
                                <label>HTTP Method *</label>
                                <select id="apiMethod" required>
                                    <option value="GET">GET</option>
                                    <option value="POST">POST</option>
                                    <option value="PUT">PUT</option>
                                    <option value="DELETE">DELETE</option>
                                    <option value="PATCH">PATCH</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Endpoint URL *</label>
                            <input type="url" id="apiEndpoint" required placeholder="https://api.example.com/endpoint">
                        </div>
                        
                        <div class="form-group">
                            <label>API Key</label>
                            <div style="display: flex; gap: 0.5rem;">
                                <input type="text" id="apiKey" placeholder="sk-... or leave empty" style="flex: 1;">
                                <button type="button" id="testConnectionBtn" class="btn btn-small">üîå Test Connection</button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="apiDescription" rows="3" placeholder="Optional description of what this API does"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Additional Headers (JSON)</label>
                            <textarea id="apiHeaders" rows="4" placeholder='{"Content-Type": "application/json", "Authorization": "Bearer token"}'></textarea>
                            <small style="color: var(--text-secondary);">Enter headers as JSON object</small>
                        </div>
                        
                        <div class="form-group">
                            <label>Detected Fields</label>
                            <div id="detectedFields" class="fields-display"></div>
                        </div>
                        
                        <div class="form-actions">
                            <button id="saveApiBtn" class="btn btn-primary">üíæ Save API/MCP</button>
                            <button type="button" id="cancelSaveBtn" class="btn btn-secondary">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AI Models Page -->
        <div id="modelsPage" class="page">
            <div class="page-header">
                <h2>AI Model Management</h2>
                <button id="addModelBtn" class="btn btn-primary">‚ûï Add AI Model</button>
            </div>

            <div id="modelsList" class="models-table-container">
                <table class="models-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Type</th>
                            <th>Capability</th>
                            <th>Endpoint</th>
                            <th>API Key</th>
                            <th>Model</th>
                            <th>Context</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="modelsTableBody">
                        <!-- Models will be dynamically added here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- API Detail Modal -->
        <div id="apiDetailModal" class="modal" style="display: none;">
            <div class="modal-content large">
                <span class="close">&times;</span>
                <div id="apiDetailContent"></div>
            </div>
        </div>

        <!-- Add Model Modal -->
        <div id="addModelModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Add AI Model</h2>
                <form id="addModelForm">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="modelName" required placeholder="e.g., kimik2">
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="modelType" required>
                            <option value="custom">Custom</option>
                            <option value="openai">OpenAI</option>
                            <option value="anthropic">Anthropic</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Capability</label>
                        <select id="modelCapability" required>
                            <option value="text_generc">Text Generation</option>
                            <option value="text_analysis">Text Analysis</option>
                            <option value="code_analysis">Code Analysis</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>API Endpoint</label>
                        <input type="url" id="modelEndpoint" required placeholder="https://api.example.com">
                    </div>
                    <div class="form-group">
                        <label>API Key</label>
                        <input type="text" id="modelApiKey" required placeholder="sk-...">
                    </div>
                    <div class="form-group">
                        <label>Model Name</label>
                        <input type="text" id="modelModelName" required placeholder="e.g., kimi-k2-090">
                    </div>
                    <div class="form-group">
                        <label>Context Window</label>
                        <input type="number" id="modelContext" required placeholder="256000">
                    </div>
                    <button type="submit" class="btn btn-primary btn-block">üíæ Save Model</button>
                </form>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
